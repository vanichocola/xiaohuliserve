(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-commission-poster"],{"0705":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=getApp(),n={data:function(){return{qrcode:"",posterList:[],current:0}},onLoad:function(t){this.getPoster()},methods:{getPoster:function(){var t=this;i.globalData.util.request({url:"/commission/poster"}).then((function(e){t.setData({qrcode:e.data.qrcode,posterList:e.data.posterList})}))},swiperChange:function(t){this.setData({current:t.detail.current})},saveImage:function(){var t=uni.createCanvasContext("poster"),e=this.posterList[this.current],a=this.qrcode,i=!1,n=!1;uni.showLoading({title:"生成中"}),uni.downloadFile({url:e.img,success:function(s){t.drawImage(s.tempFilePath,0,0,500,750),i=!0,uni.downloadFile({url:a,success:function(a){t.drawImage(a.tempFilePath,e.hole.x,e.hole.y,e.hole.w,e.hole.h),n=!0}})}});var s=setInterval((function(){i&&n&&(clearInterval(s),t.draw(),uni.hideLoading(),setTimeout((function(){uni.canvasToTempFilePath({canvasId:"poster",destWidth:500,destHeight:750,quality:1,fileType:"jpg",success:function(t){uni.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){util.showSuccessToast("已保存到相册")},fail:function(t){console.log("error",t),util.showErrorToast("保存失败，请检查是否有保存到相册权限")}})}})}),300))}),500)}}};e.default=n},"08d4":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page"},[a("v-uni-swiper",{staticClass:"poster-list",attrs:{"previous-margin":"125rpx","next-margin":"125rpx"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.swiperChange.apply(void 0,arguments)}}},t._l(t.posterList,(function(e,i){return a("v-uni-swiper-item",{key:i,staticClass:"item"},[a("v-uni-view",{staticClass:"poster",style:i===t.current?"transform: scale(1)":"transform: scale(0.8)"},[a("v-uni-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.img}}),a("v-uni-image",{style:"left: "+e.hole.x+"rpx; top: "+e.hole.y+"rpx; width: "+e.hole.w+"rpx; height:"+e.hole.h+"rpx;",attrs:{src:t.qrcode}})],1)],1)})),1),a("v-uni-canvas",{staticStyle:{display:"block",height:"750px",width:"500px",position:"absolute",left:"-500px",top:"-750px"},attrs:{canvasId:"poster"}}),t.posterList.length>0?a("v-uni-view",{staticClass:"btn-save",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveImage.apply(void 0,arguments)}}},[t._v("保存到相册")]):t._e()],1)},n=[]},3168:function(t,e,a){"use strict";a.r(e);var i=a("08d4"),n=a("746a");for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("8c6d");var o=a("f0c5"),r=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"23b8cbad",null,!1,i["a"],void 0);e["default"]=r.exports},"568f":function(t,e,a){var i=a("f95f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("536154da",i,!0,{sourceMap:!1,shadowMode:!1})},"746a":function(t,e,a){"use strict";a.r(e);var i=a("0705"),n=a.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},"8c6d":function(t,e,a){"use strict";var i=a("568f"),n=a.n(i);n.a},f95f:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,"uni-page-body[data-v-23b8cbad]{background:#f7f7f7}body.?%PAGE?%[data-v-23b8cbad]{background:#f7f7f7}.page[data-v-23b8cbad]{width:100%;height:100%;overflow:hidden}.poster-list[data-v-23b8cbad]{width:100%;height:%?750?%;margin-top:%?100?%}.poster-list .item[data-v-23b8cbad]{width:%?500?%;height:%?750?%}.poster[data-v-23b8cbad]{width:100%;height:100%;position:relative;transition:-webkit-transform .4s linear 0s;transition:transform .4s linear 0s;transition:transform .4s linear 0s,-webkit-transform .4s linear 0s}.poster uni-image[data-v-23b8cbad]{position:absolute;width:100%;height:100%}.btn-save[data-v-23b8cbad]{width:%?500?%;margin:%?160?% auto %?40?% auto;font-size:%?32?%;font-weight:500;color:#fff;text-align:center;background-image:linear-gradient(90deg,#ff5e41,#fc4353);height:%?80?%;line-height:%?80?%;border-radius:%?80?%;box-shadow:0 0 %?20?% rgba(252,67,83,.3)}",""]),t.exports=e}}]);